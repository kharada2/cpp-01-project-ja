# cpp-01-project-ja

## セットアップと実行の手順
- ビルド
```
$ g++ -std=c++17 src/*.cpp src/*.h -o main
```

- 実行
```
$ ./main
```

## ゲーム内容説明

- コマンドを使用して自車を操作します。
- 時間は１コマンドで１消費します。  
- 時間切れになる前に目的地（G）に到達できたらゲームクリアとなります。 
- ただし、途中で燃料が０になった場合はGAMEOVERとなるため、途中で給油をしながら走行してください。
- 自車周辺の地図のみが表示されるため、「目的地までの距離」情報を参考にして、目的地を目指してください。

### 罰則条件
- 制限速度超過で走行した場合、ペナルティーとして時間を５マイナスします。

### 操作コマンド一覧

| コマンド | 内容 |
| :---: | :---: | 
| a | 加速 | 
| b | 減速 | 
| g | 直進 | 
| s | 停止 | 
| r | 右折 | 
| l | 左折 | 
| u | Uターン| 

### 表示情報

| 状態| 内容 |
| :---: | :--- | 
| 時間 |  一回の操作（コマンド）で１消費する。|
| 速度 |  一回の操作で移動できる距離。|
| 燃料 | 距離１進行するたびに１消費する。給油回数は２回までです。|
| 天気 |  雪が一定確率で振る。雪のときは、ホワイトアウトします。|
| 地図 | 自車周辺の地図を表示。|
| 目的地までの距離 | 目的地までの距離を表示。この情報をもとに目的地の位置を推測する。|

### ランドマーク

| ランドマーク | 名前 |内容 |
| :---: | :--- | :--- | 
| G | 目的地 | 目的地に到達できればゴール|
| F | ガソリンスタンド | 給油できる。ただし、給油の上限制限あり。|
| C | コンビニ | 情報が表示されるのみ。|
| ◇ | 高速道路 | 高速道路では制限速度が上がる。一般道路よりも速く移動可能。|

### 要件に対する達成度（自己評価）
| 要件 | 達成可否 |
| :---: | :--- |
| ユーザーのコマンド入力に対応する | 〇 |
| 基本的な制御を行う |  〇|
| 街の地図を作成する |  〇|
| 地図上にランドマークを配置する |  〇|
| 情報を表示する |  〇|
| 発展レベルの要件を満たす |  〇「燃料システムを実装する」を実装しました。|


## 直面した課題
1. 右に移動、左に移動ではなく、右折、左折をできるようにするためには、自車の状態として「位置情報」に加えて「向き」の概念が必要である。  
今回の実装では、自車位置によらず不変な「方角」という概念を追加し、自車座標系を方角に応じて切り替えることで自車の進行方向に対して右折、左折判定ができるように対応した。

2. 速度を上げたとき（＝１回の移動で２マス進めるとき）に、移動後の地点に対して壁の衝突判定をすると、
壁にすり抜けてしてしまう問題が生じた。  
この対策として、２マス以上進む場合でも、内部的にはfor文を用いて１マスずつ処理するように変更した。

3. 行き止まりにあたったときに、（壁がある方向に対して車両を向けられなくした結果）操作できなくなった。  
今回の実装では、Uターンできるコマンドを追加し、そのような地点に行きついたときでもゲームを続行できるようにした。

4. 表示を見やすくするために、地図をstringで定義しようと考えたが、switch文などが使えなくなり処理が見づらくなる課題があった。  
そのため、地図の要素はchar型で定義し、出力のときにstringに変換することで見やすさの向上を図った。

## 今後の改善

- ユーザーのコマンドに対して、Enterを押さずに確定できるようにしたい。
- 同じような処理がいくつかあるので、共通関数化したい。
- 雨モードを追加し、雨の時は倍進むなどの機能を追加したい。